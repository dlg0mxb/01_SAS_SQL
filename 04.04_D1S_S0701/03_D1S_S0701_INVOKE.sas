PROC SQL ;

OPTIONS MISSING='';

/*Create Temp table to load the extracted Data*/

	CREATE TABLE WORK.S0701_D1S_INV AS 

		SELECT 

			CASE 
				WHEN ENTITY_LEI_STATUS = '1' THEN 'LEI/'
			 	ELSE 'SC/' 
			END||ENTITY_LEI_CD AS C0020

			, CASE 
				WHEN A5 = 'ISIN' THEN 'ISIN/' 
				WHEN A5 = 'CUSIP' THEN 'CUSIP/' 
				WHEN A5 = 'UNDERTAKING' THEN 'CAU/'
				ELSE 'CHECK_X_EIOPA_CD' END||A4   AS C0040

			, A50 AS C0010

			, SUBSTR(A15,3,1) AS C0060

			, C0070 AS C0070

			, CASE WHEN C0080 = '-' THEN '' ELSE C0080 END AS C0080

			, CASE WHEN C0090 = '-' THEN '' ELSE C0090 END AS C0090

			, CASE WHEN C0100 = '-' THEN '' ELSE C0100 END AS C0100
			  
			, CASE WHEN C0110 = '-' THEN '' ELSE C0110 END AS C0110

			, CASE WHEN C0120 = '-' THEN '' ELSE C0120 END AS C0120

		 	, COALESCE(PUT(C0130,21.2),'') AS C0130

			, C0140 AS C0140

			, CASE 
				WHEN BRS_CPN = 'FIXED' THEN PUT(C0150,21.2)
				ELSE ''
			   END AS C0150

			, CASE 
				WHEN BRS_CPN <> 'FIXED' THEN CASE WHEN C0160 = '-' THEN '' ELSE C0160 END
				ELSE ''
			  END AS C0160

			, COALESCE(PUT(C0170,10.5),'') AS C0170

			, C0180/100 AS C0180 FORMAT=10.4

			, C0190/100 AS C0190 FORMAT=10.4
	
		FROM 
			WORK.S0701_D1S_BASE

		ORDER BY 
			C0040;
QUIT;