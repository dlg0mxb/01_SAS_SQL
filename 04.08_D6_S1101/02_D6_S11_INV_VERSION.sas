PROC SQL ;

OPTIONS MISSING='';

/*Create Temp table to load the extracted Data*/

	CREATE TABLE WORK.S1101_D6_INV AS 

		SELECT 

			CASE 
				WHEN ENTITY_LEI_STATUS = '1' THEN 'LEI/'
				WHEN ENTITY_LEI_STATUS = '2' THEN 'SC/'
				ELSE ENTITY_LEI_STATUS 
			END||ENTITY_LEI_CD AS C0020

			, CASE 
				WHEN A5 = 'UNDERTAKING' THEN 'CAU/INST/'	
				WHEN A5 = 'ISIN'  		THEN 'ISIN/'	 
				WHEN A5 = 'CUSIP'  		THEN 'CUSIP/'
				ELSE 'DATA QUALITY ISSUE'
			  END||A4 AS C0040

			, A50 AS C0010

			, X_DEBTOR_NM AS C0060

			, X_DEBTOR_GRP_NM AS C0070

			, A12 AS C0080
		
			, CASE WHEN COALESCE( A22PAM, A22BRS) = 'Not Applicable - CIC' THEN '' ELSE  COALESCE( A22PAM, A22BRS) END  AS C0090

			, CASE WHEN COALESCE( A22APAM, A22ABRS) = 'Not Applicable - CIC' THEN '' ELSE COALESCE( A22APAM, A22ABRS) END AS C0100

			, A24 AS C0110

			, A26FIN_SDW AS C0120

			, COALESCE( A30PAM, A30BRS) AS C0130

			, X_ASSET_PLEDGED_TYPE AS C0140

			, '' AS END_PART_1

			, CASE 
				WHEN A5 = 'UNDERTAKING' THEN 'CAU/INST/'	
				WHEN A5 = 'ISIN'  		THEN 'ISIN/'	 
				WHEN A5 = 'CUSIP'  		THEN 'CUSIP/'
				ELSE 'DATA QUALITY ISSUE'
			  END||A4 AS C0040_P2

			, A7 AS C0150 

			, A8 AS C0160 

			 , CASE 
				WHEN A33 = '1' THEN 'LEI/' 
				WHEN A33 = '2' THEN 'SC/'
				ELSE '' 
				END||A31 AS C0170 

			, A9 AS C0190 

			, A10 AS C0200 

			 , CASE 
				WHEN A33GROUP = '1' THEN 'LEI/' 
				WHEN A33GROUP = '2' THEN 'SC/'
				ELSE ''  
			   END||A32 AS C0210 

	 		, A11 AS C0230

			, A13 AS C0240 

			, A15 AS C0250

			, CASE WHEN COALESCE( A23PAM, A23BRS) = 'Not Applicable - CIC'  THEN '' ELSE COALESCE( A23PAM, A23BRS) END AS C0260

			, ( INPUT ( COALESCE( A23APAM, A23ABRS) , 12.8 )/100) AS C0270

			, CASE WHEN A28 = 'Not Applicable - CIC'  THEN '' ELSE A28 END  AS C0280	

		FROM 
			WORK.S1101_D6_BASE

		ORDER BY 
			C0250
			, C0040
		;

QUIT;
